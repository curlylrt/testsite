<!DOCTYPE html "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <meta http-equiv="content-type" content="text/html; charset=utf-8" />
 <title>MarkerWithLabel Example</title>
 <style type="text/css">
   .labels {
     color: red;
     background-color: white;
     font-family: "Lucida Grande", "Arial", sans-serif;
     font-size: 10px;
     font-weight: bold;
     text-align: center;
     width: 40px;     
     border: 2px solid black;
     white-space: nowrap;
   }

      #map_canvas {
        height: 100%;
        width: 100%;
        margin: 0px;
        padding: 0px;
        float: left;
      }
 </style>
 <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
 <script type="text/javascript" src="{{ STATIC_URL }}src/markerwithlabel.js"></script>
 <script type="text/javascript">
var map;
var geocoder;
function initMap() {
     var homeLatLng = new google.maps.LatLng(49.47805, -123.84716);
     var latLng = new google.maps.LatLng(49.47805, -123.84716);
     map = new google.maps.Map(document.getElementById('map_canvas'), {
       zoom: 12,
       center: latLng,
     });


    }

        function addMarker(address, name, day) {
          geocoder = new google.maps.Geocoder();
          geocoder.geocode( { 'address': address}, function(results, status) {
                if (status == google.maps.GeocoderStatus.OK) {
                  map.setCenter(results[0].geometry.location);
                  map.setZoom(11);
 var infowindow = new google.maps.InfoWindow({
      content: name
  });
      var marker = new MarkerWithLabel({
       position: results[0].geometry.location,
       draggable: true,
       map: map,
       labelContent: day,
       labelAnchor: new google.maps.Point(22, 0),
       labelClass: "labels", // the CSS class for the label
       labelStyle: {opacity: 0.75}
     });
 google.maps.event.addListener(marker, 'click', function() {
    infowindow.open(map,marker);
  });

                } else {
                  alert('Geocode was not successful for the following reason: ' + status);
                }
          });
        }
 </script>
</head>
<body>
 <div id="map_canvas" style="height: 100%; width: 50%"></div>
 <div id="log"></div>

 <script>initMap()</script>
<div style="float:right">
{% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}
<ol>
{% for entry in sets %}
    {% with day=forloop.counter %}
    {% for item in entry %}
        {% if forloop.counter0 == 0 %}
            <li><h3>Time: {{ item }}</h3></li<br>
        {% else %}
            <label>Place: {{ place_list|get_place_name:item }}</label><br>
<script>
        addMarker("{{ place_list|get_place_address:item }}", "{{ place_list|get_place_name:item }}", "第{{ day }}天");
</script>
        {% endif %}
    {% endfor %}
    {% endwith %}
{% endfor %}
</ol>
</div>
</body>
</html>

